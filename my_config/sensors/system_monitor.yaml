# ############################################################################
# Hardware sensors Z9PA - NVME
# ############################################################################

  - platform: template
    sensors:
      f20_single_session_write:
        value_template: "{{ (states('sensor.md5_session_write')|float * 0.25) | round(1) }}"
        unit_of_measurement: 'Gb'
      f20_tb_written:
        value_template: '1000'
        unit_of_measurement: 'Gb'

  - platform: statistics
    entity_id: sensor.f20_single_session_write
    name: f20_statistics
    max_age:
      minutes: 60

  - platform: statistics
    entity_id: sensor.nvme0_session_write
    name: nvme0_statistics
    max_age:
      minutes: 60

  - platform: statistics
    entity_id: sensor.nvme1_session_write
    name: nvme1_statistics
    max_age:
      minutes: 60

  - platform: statistics
    entity_id: sensor.sdb_session_write
    name: sdb_statistics
    max_age:
      minutes: 60

  - platform: template
    sensors:
      nvme0_write_change_1h:
        value_template: "{{ state_attr('sensor.nvme0_statistics','change') }}"
        unit_of_measurement: 'Gb'
      nvme1_write_change_1h:
        value_template: "{{ state_attr('sensor.nvme1_statistics','change') }}"
        unit_of_measurement: 'Gb'
      sdb_write_change_1h:
        value_template: "{{ state_attr('sensor.sdb_statistics','change') }}"
        unit_of_measurement: 'Gb'
      f20_write_change_1h:
        value_template: "{{ state_attr('sensor.f20_statistics','change') }}"
        unit_of_measurement: 'Gb'

  - platform: template
    sensors:
      f20_gb_per_hour:
        friendly_name: f20 Gb per hour
        unit_of_measurement: Gb
        entity_id: sensor.time, sensor.md5_session_write
        icon_template: mdi:clock
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (states('sensor.f20_single_session_write')|float / states('sensor.host_uptime')|float)|round(2) }}
          {% else %}
          {{states('sensor.f20_single_session_write')|float | round(2)}}
          {% endif %}
      f20_gb_per_day:
        friendly_name: f20 Gb per day
        unit_of_measurement: Gb
        icon_template: mdi:calendar
        entity_id: sensor.time, sensor.md5_session_write
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (((states('sensor.f20_single_session_write')|float) / (states('sensor.host_uptime')|float)*24)|float)|round(2) }}
          {% else %}
          {{ (states('sensor.f20_single_session_write')|float*24) | round(2)}}
          {% endif %}
      f20_life_left:
        friendly_name: f20 Calculated life left
        unit_of_measurement: years
        entity_id: sensor.time, sensor.md5_session_write
        icon_template: mdi:calendar-clock
        value_template: >-
          {%set tbw = 5000 %}
          {%set f20_tb_written = 1000 %}
          {%set per_day = states('sensor.f20_gb_per_day')|float%}
          {%if per_day == 0 %}
          {{(((tbw * 1024 - f20_tb_written) / 1 ) / 365)|round(2)}}
          {%else%}
          {{(((tbw * 1024 - f20_tb_written) / per_day ) / 365)|round(2)}}
          {%endif%}
    
      sda_gb_per_hour:
        friendly_name: sda Gb per hour
        unit_of_measurement: Gb
        entity_id: sensor.time, sensor.sda_session_write
        icon_template: mdi:clock
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (states('sensor.sda_session_write')|float / states('sensor.host_uptime')|float)|round(2) }}
          {% else %}
          {{states('sensor.sda_session_write')|float | round(2)}}
          {% endif %}
      sda_gb_per_day:
        friendly_name: sda Gb per day
        unit_of_measurement: Gb
        icon_template: mdi:calendar
        entity_id: sensor.time, sensor.sda_session_write
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (((states('sensor.sda_session_write')|float) / (states('sensor.host_uptime')|float)*24)|float)|round(2) }}
          {% else %}
          {{ (states('sensor.sda_session_write')|float*24) | round(2)}}
          {% endif %}
      sda_life_left:
        friendly_name: sda Calculated life left
        unit_of_measurement: years
        entity_id: sensor.time, sensor.sda_session_write
        icon_template: mdi:calendar-clock
        value_template: >-
          {%set tbw = 35 %}
          {%set per_day = states('sensor.sda_gb_per_day')|float%}
          {%if per_day == 0 %}
          {{(((tbw * 1024 - states('sensor.sda_tb_written')|float) / 1 ) / 365)|round(2)}}
          {%else%}
          {{(((tbw * 1024 - states('sensor.sda_tb_written')|float) / per_day ) / 365)|round(2)}}
          {%endif%}

      sdb_gb_per_hour:
        friendly_name: sdb Gb per hour
        unit_of_measurement: Gb
        entity_id: sensor.time, sensor.sdb_session_write
        icon_template: mdi:clock
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (states('sensor.sdb_session_write')|float / states('sensor.host_uptime')|float)|round(2) }}
          {% else %}
          {{states('sensor.sdb_session_write')|float | round(2)}}
          {% endif %}
      sdb_gb_per_day:
        friendly_name: sdb Gb per day
        unit_of_measurement: Gb
        icon_template: mdi:calendar
        entity_id: sensor.time, sensor.sdb_session_write
        value_template: >-
          {{ (states('sensor.sdb_gb_per_hour')|float *24) | round(2) }}
      sdb_life_left:
        friendly_name: sdb Calculated life left
        unit_of_measurement: years
        entity_id: sensor.time, sensor.sdb_session_write
        icon_template: mdi:calendar-clock
        value_template: >-
          {%set tbw = 150 %}
          {%set per_day = states('sensor.sdb_gb_per_day')|float%}
          {%if per_day == 0 %}
          {{(((tbw * 1024 - states('sensor.sdb_tb_written')|float) / 1 ) / 365)|round(2)}}
          {%else%}
          {{(((tbw * 1024 - states('sensor.sdb_tb_written')|float) / per_day ) / 365)|round(2)}}
          {%endif%}

      nvme0_gb_per_hour:
        friendly_name: NVME0 Gb per hour
        unit_of_measurement: Gb
        entity_id: sensor.time, sensor.nvme0_session_write
        icon_template: mdi:clock
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (states('sensor.nvme0_session_write')|float / states('sensor.host_uptime')|float)|round(2) }}
          {% else %}
          {{states('sensor.nvme0_session_write')|float | round(2)}}
          {% endif %}
      nvme0_gb_per_day:
        friendly_name: NVME0 Gb per day
        unit_of_measurement: Gb
        icon_template: mdi:calendar
        entity_id: sensor.time, sensor.nvme0_session_write
        value_template: >-
          {{ (states('sensor.nvme0_gb_per_hour')|float *24) | round(2) }}
      nvme0_life_left:
        friendly_name: NVME0 Calculated life left
        unit_of_measurement: years
        entity_id: sensor.time, sensor.nvme0_session_write
        icon_template: mdi:calendar-clock
        value_template: >-
          {%set tbw = 160 %}
          {%set per_day = states('sensor.nvme0_gb_per_day')|float%}
          {%if per_day == 0 %}
          {{(((tbw * 1024 - states('sensor.nvme0_tb_written')|float) / 1 ) / 365)|round(2)}}
          {%else%}
          {{(((tbw * 1024 - states('sensor.nvme0_tb_written')|float) / per_day ) / 365)|round(2)}}
          {%endif%}

      nvme1_gb_per_hour:
        friendly_name: NVME1 Gb per hour
        unit_of_measurement: Gb
        entity_id: sensor.time, sensor.nvme1_session_write
        icon_template: mdi:clock
        value_template: >-
          {% set uptime = states('sensor.host_uptime') %}
          {% if uptime | float  > 0 %}
          {{ (states('sensor.nvme1_session_write')|float / states('sensor.host_uptime')|float)|round(2) }}
          {% else %}
          {{states('sensor.nvme1_session_write')|float | round(2)}}
          {% endif %}
      nvme1_gb_per_day:
        friendly_name: NVME1 Gb per day
        unit_of_measurement: Gb
        icon_template: mdi:calendar
        entity_id: sensor.time, sensor.nvme1_session_write
        value_template: >-
          {{ (states('sensor.nvme1_gb_per_hour')|float *24) | round(2) }}
      nvme1_life_left:
        friendly_name: NVME1 Calculated life left
        unit_of_measurement: years
        entity_id: sensor.time, sensor.nvme1_session_write
        icon_template: mdi:calendar-clock
        value_template: >-
          {%set tbw = 160 %}
          {%set per_day = states('sensor.nvme1_gb_per_day')|float%}
          {%if per_day == 0 %}
          {{(((tbw * 1024 - states('sensor.nvme1_tb_written')|float) / 1 ) / 365)|round(2)}}
          {%else%}
          {{(((tbw * 1024 - states('sensor.nvme1_tb_written')|float) / per_day ) / 365)|round(2)}}
          {%endif%}
          
      # nvme0_gb_per_day:
      #   friendly_name: NVME0 Gb per day
      #   unit_of_measurement: Gb
      #   icon_template: mdi:calendar
      #   entity_id: sensor.nvme0_session_write
      #   value_template: >-
      #     {{ (( states('sensor.nvme0_session_write')|float / states('sensor.host_uptime')|float ) *24) | round(0) }}
      # nvme0_gb_per_hour:
      #   friendly_name: NVME0 Gb per hour
      #   unit_of_measurement: Gb
      #   entity_id: sensor.nvme0_session_write
      #   icon_template: mdi:clock
      #   value_template: >-
      #     {{ (( states('sensor.nvme0_session_write')|float / states('sensor.host_uptime')|float ) ) | round(0) }}
      # nvme0_life_left:
      #   friendly_name: NVME0 Calculated life left
      #   unit_of_measurement: years
      #   entity_id: sensor.nvme0_session_write
      #   icon_template: mdi:calendar-clock
      #   value_template: >-
      #     {{ (((160 - states('sensor.nvme0_tb_written')|float) / (((( states('sensor.nvme0_session_write')|float / states('sensor.host_uptime')|float ) *24) ) / 1024)) / 365) |  float | round(1)  }}

      # nvme1_gb_per_day:
      #   friendly_name: NVME1 Gb per day
      #   unit_of_measurement: Gb
      #   entity_id: sensor.nvme1_session_write
      #   icon_template: mdi:calendar
      #   value_template: >-
      #     {{ (( states('sensor.nvme1_session_write')|float / states('sensor.host_uptime')|float ) *24) | round(0) }}
      # nvme1_gb_per_hour:
      #   friendly_name: NVME1 Gb per hour
      #   unit_of_measurement: Gb
      #   entity_id: sensor.nvme1_session_write
      #   icon_template: mdi:clock
      #   value_template: >-
      #     {{ (( states('sensor.nvme1_session_write')|float / states('sensor.host_uptime')|float ) ) | round(0) }}
      # nvme1_life_left:
      #   friendly_name: NVME1 Calculated life left
      #   icon_template: mdi:calendar-clock
      #   entity_id: sensor.nvme1_session_write
      #   unit_of_measurement: years
      #   value_template: >-
      #     {{ (((160 - states('sensor.nvme1_tb_written')|float) / (((( states('sensor.nvme1_session_write')|float / states('sensor.host_uptime')|float ) *24) ) / 1024)) / 365) |  float | round(1)  }}

# ############################################################################
# Hardware sensors Z9PA - Internal HA
# ############################################################################
  - platform: cpuspeed

  - platform: systemmonitor
    resources:
      - type: last_boot
      - type: memory_use_percent
      - type: processor_use
      - type: load_1m
      - type: load_5m
      - type: load_15m
      - type: disk_use_percent
        arg: /
  - platform: command_line
    name: CPU Temperature
    command: "cat /sys/class/thermal/thermal_zone0/temp"
    unit_of_measurement: "°C"
    value_template: '{{ value | multiply(0.001) | round(0) }}'


  #- platform: command_line
  #  name: GPU Temperature
  #  command: "/opt/vc/bin/vcgencmd measure_temp"
  #  unit_of_measurement: "°C"
  #  value_template: '{{ value | replace("temp=", "") | replace("''C", "") | round(0) }}'


# ############################################################################
# Hardware sensors (Zero2mb) - MQTT
# ############################################################################
#  - platform: mqtt
#    name: "Zero2mb CPU Usage"
#    state_topic: "zero2mb/cpu_percent"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:speedometer
#    
#  - platform: mqtt
#    name: "Zero2mb CPU Temp"
#    state_topic: "zero2mb/sensors_temperatures/cpu-thermal"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '°C'
#    icon: mdi:thermometer
#    
#  - platform: mqtt
#    name: "Zero2mb RAM Usage"
#    state_topic: "zero2mb/virtual_memory/percent"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:memory
#
#  - platform: mqtt
#    name: "Zero2mb Disk Usage"
#    state_topic: "zero2mb/disk_usage/percent/|"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:chip


# ############################################################################
# Hardware sensors (Zero2mqtt) - MQTT
# ############################################################################
#  - platform: mqtt
#    name: "Zero2mqtt CPU Usage"
#    state_topic: "zero2mqtt/cpu_percent"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:speedometer
#    
#  - platform: mqtt
#    name: "Zero2mqtt CPU Temp"
#    state_topic: "zero2mqtt/sensors_temperatures/cpu-thermal"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '°C'
#    icon: mdi:thermometer
#    
#  - platform: mqtt
#    name: "Zero2mqtt RAM Usage"
#    state_topic: "zero2mqtt/virtual_memory/percent"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:memory#
#
#  - platform: mqtt
#    name: "Zero2mqtt Disk Usage"
#    state_topic: "zero2mqtt/disk_usage/percent/|"
#    value_template: '{{ value | int | round(0) }}'
#    unit_of_measurement: '%'
#    icon: mdi:chip

# ############################################################################
# Hardware sensors (RPI) - MQTT
# ############################################################################
  - platform: mqtt
    name: "RPI CPU Usage"
    state_topic: "rpi/cpu_percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:speedometer
    
  - platform: mqtt
    name: "RPI CPU Temp"
    state_topic: "rpi/sensors_temperatures/cpu-thermal"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
  - platform: mqtt
    name: "RPI RAM Usage"
    state_topic: "rpi/virtual_memory/percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:memory

  - platform: mqtt
    name: "RPI SSD Usage"
    state_topic: "rpi/disk_usage/percent/|"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:chip

# ############################################################################
# Hardware sensors (j3455) - MQTT
# ############################################################################
  - platform: mqtt
    name: "j3455 CPU Usage"
    state_topic: "j3455/cpu_percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:speedometer
    
  - platform: mqtt
    name: "j3455 CPU Temp"
    state_topic: "j3455/sensors_temperatures/coretemp/0"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
  - platform: mqtt
    name: "j3455 RAM Usage"
    state_topic: "j3455/virtual_memory/percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:memory

  - platform: mqtt
    name: "j3455 SSD Usage"
    state_topic: "j3455/disk_usage/percent/|"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:chip


# ############################################################################
# Hardware sensors (IPMI) - MQTT
# ############################################################################

  - platform: mqtt
    name: "IPMI CPU1 Temp"
    state_topic: "ubuntu/ipmi/cpu1_temp"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "IPMI CPU2 Temp"
    state_topic: "ubuntu/ipmi/cpu2_temp"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "IPMI TR1 Temp"
    state_topic: "ubuntu/ipmi/tr1_temp"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "IPMI TR2 Temp"
    state_topic: "ubuntu/ipmi/tr2_temp"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "IPMI CPU Fan1"
    state_topic: "ubuntu/ipmi/cpu_fan1"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI CPU Fan2"
    state_topic: "ubuntu/ipmi/cpu_fan2"
    value_template: '{{ value | int | round(0)}}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Rear Fan 1"
    state_topic: "ubuntu/ipmi/rear_fan1"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Rear Fan 2"
    state_topic: "ubuntu/ipmi/rear_fan2"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Front Fan 1"
    state_topic: "ubuntu/ipmi/frnt_fan1"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Front Fan 2"
    state_topic: "ubuntu/ipmi/frnt_fan2"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Front Fan 3"
    state_topic: "ubuntu/ipmi/frnt_fan3"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan

  - platform: mqtt
    name: "IPMI Front Fan 4"
    state_topic: "ubuntu/ipmi/frnt_fan4"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: 'RPM'
    icon: mdi:fan


# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - System Stats
# ############################################################################

  - platform: mqtt
    name: "CPU Usage"
    state_topic: "ubuntu/cpu_percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:speedometer
    
  - platform: mqtt
    name: "CPU1 Package Temp"
    state_topic: "ubuntu/sensors_temperatures/coretemp/0"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
  - platform: mqtt
    name: "CPU2 Package Temp"
    state_topic: "ubuntu/sensors_temperatures/coretemp/7"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - RAM Usage
# ############################################################################
  - platform: mqtt
    name: "RAM Usage"
    state_topic: "ubuntu/virtual_memory/percent"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:memory

# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - Drives Usage
# ############################################################################
  - platform: mqtt
    name: "SSD Usage"
    state_topic: "ubuntu/disk_usage/md0"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:chip
    
  - platform: mqtt
    name: "840pro Usage"
    state_topic: "ubuntu/disk_usage/840pro"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:chip

  - platform: mqtt
    name: "Video Usage"
    state_topic: "ubuntu/disk_usage/video"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:harddisk

  - platform: mqtt
    name: "Media Usage"
    state_topic: "ubuntu/disk_usage/md2"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:harddisk

  - platform: mqtt
    name: "Back_2Tb Usage"
    state_topic: "ubuntu/disk_usage/md1"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:harddisk

  - platform: mqtt
    name: "320l Usage"
    state_topic: "ubuntu/disk_usage/320l"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:nas
    
  - platform: mqtt
    name: "md5 Usage"
    state_topic: "ubuntu/disk_usage/md5"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '%'
    icon: mdi:chip

# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - Drives Temperature
# ############################################################################
  - platform: mqtt
    name: "NVME0 Temp"
    state_topic: "ubuntu/disk_temp/nvme0"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
  - platform: mqtt
    name: "NVME1 Temp"
    state_topic: "ubuntu/disk_temp/nvme1"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sda Temp"
    state_topic: "ubuntu/disk_temp/sda"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdb Temp"
    state_topic: "ubuntu/disk_temp/sdb"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdc Temp"
    state_topic: "ubuntu/disk_temp/sdc"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdd Temp"
    state_topic: "ubuntu/disk_temp/sdd"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sde Temp"
    state_topic: "ubuntu/disk_temp/sde"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdf Temp"
    state_topic: "ubuntu/disk_temp/sdf"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdg Temp"
    state_topic: "ubuntu/disk_temp/sdg"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdh Temp"
    state_topic: "ubuntu/disk_temp/sdh"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdi Temp"
    state_topic: "ubuntu/disk_temp/sdi"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdj Temp"
    state_topic: "ubuntu/disk_temp/sdj"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdk Temp"
    state_topic: "ubuntu/disk_temp/sdk"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
  - platform: mqtt
    name: "sdl Temp"
    state_topic: "ubuntu/disk_temp/sdl"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer

  - platform: mqtt
    name: "sdm Temp"
    state_topic: "ubuntu/disk_temp/sdm"
    value_template: '{{ value | int | round(0) }}'
    unit_of_measurement: '°C'
    icon: mdi:thermometer
    
# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - SSD Drives Smart Data
# ############################################################################
  - platform: mqtt
    name: "NVME0 Tb Written"
    state_topic: "ubuntu/nvme0_tb_total"
    value_template: '{{ value| float |round(1)}}'
    unit_of_measurement: 'Tb'
    icon: mdi:chip

  - platform: mqtt
    name: "NVME1 Tb Written"
    state_topic: "ubuntu/nvme1_tb_total"
    value_template: '{{ value| float |round(1)}}'
    unit_of_measurement: 'Tb'
    icon: mdi:chip

  - platform: mqtt
    name: "sda Tb Written"
    state_topic: "ubuntu/sda_tb_total"
    value_template: '{{ value| float |round(2)}}'
    unit_of_measurement: 'Tb'
    icon: mdi:chip
    
  - platform: mqtt
    name: "sdb Tb Written"
    state_topic: "ubuntu/sdb_tb_total"
    value_template: '{{ value| float |round(1)}}'
    unit_of_measurement: 'Tb'
    icon: mdi:chip

# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - Drives Read\Write Stats
# ############################################################################
  - platform: mqtt
    name: NVME0 Session Write
    state_topic: "ubuntu/disk_stat/nvme0_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: NVME0 Session Read
    state_topic: "ubuntu/disk_stat/nvme0_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: NVME1 Session Write
    state_topic: "ubuntu/disk_stat/nvme1_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: NVME1 Session Read
    state_topic: "ubuntu/disk_stat/nvme1_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: sda Session Write
    state_topic: "ubuntu/disk_stat/sda_gb_write"
    value_template: '{{ value| float | round(1) }}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sda Session Read
    state_topic: "ubuntu/disk_stat/sda_gb_read"
    value_template: '{{ value| float | round(1) }}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box
    
  - platform: mqtt
    name: sdb Session Write
    state_topic: "ubuntu/disk_stat/sdb_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdb Session Read
    state_topic: "ubuntu/disk_stat/sdb_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box


# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - Session States (Drives R\W)
# ############################################################################  
  - platform: mqtt
    name: sdc Session Write
    state_topic: "ubuntu/disk_stat/sdc_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdc Session Read
    state_topic: "ubuntu/disk_stat/sdc_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: sdd Session Write
    state_topic: "ubuntu/disk_stat/sdd_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdd Session Read
    state_topic: "ubuntu/disk_stat/sdd_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box


  - platform: mqtt
    name: sde Session Write
    state_topic: "ubuntu/disk_stat/sde_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sde Session Read
    state_topic: "ubuntu/disk_stat/sde_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: sdf Session Write
    state_topic: "ubuntu/disk_stat/sdf_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdf Session Read
    state_topic: "ubuntu/disk_stat/sdf_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: sdg Session Write
    state_topic: "ubuntu/disk_stat/sdg_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdg Session Read
    state_topic: "ubuntu/disk_stat/sdg_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: sdh Session Write
    state_topic: "ubuntu/disk_stat/sdh_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdh Session Read
    state_topic: "ubuntu/disk_stat/sdh_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box
    
  - platform: mqtt
    name: sdi Session Write
    state_topic: "ubuntu/disk_stat/sdi_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdi Session Read
    state_topic: "ubuntu/disk_stat/sdi_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box
    
  - platform: mqtt
    name: sdj Session Write
    state_topic: "ubuntu/disk_stat/sdj_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdj Session Read
    state_topic: "ubuntu/disk_stat/sdj_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box
    
  - platform: mqtt
    name: sdk Session Write
    state_topic: "ubuntu/disk_stat/sdk_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdk Session Read
    state_topic: "ubuntu/disk_stat/sdk_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box  
  
  - platform: mqtt
    name: sdl Session Write
    state_topic: "ubuntu/disk_stat/sdl_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: sdl Session Read
    state_topic: "ubuntu/disk_stat/sdl_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box


# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - RAID Stats
# ############################################################################
  - platform: mqtt
    name: md0 Session Write
    state_topic: "ubuntu/disk_stat/md0_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box
    
  - platform: mqtt
    name: md0 Session Read
    state_topic: "ubuntu/disk_stat/md0_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: md1 Session Write
    state_topic: "ubuntu/disk_stat/md1_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: md1 Session Read
    state_topic: "ubuntu/disk_stat/md1_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: md2 Session Write
    state_topic: "ubuntu/disk_stat/md2_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: md2 Session Read
    state_topic: "ubuntu/disk_stat/md2_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: Video Session Write
    state_topic: "ubuntu/disk_stat/video_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: Video Session Read
    state_topic: "ubuntu/disk_stat/video_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: md3 Session Write
    state_topic: "ubuntu/disk_stat/md3_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: md3 Session Read
    state_topic: "ubuntu/disk_stat/md3_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: md4 Session Write
    state_topic: "ubuntu/disk_stat/md4_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: md4 Session Read
    state_topic: "ubuntu/disk_stat/md4_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

  - platform: mqtt
    name: md5 Session Write
    state_topic: "ubuntu/disk_stat/md5_gb_write"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-w-box

  - platform: mqtt
    name: md5 Session Read
    state_topic: "ubuntu/disk_stat/md5_gb_read"
    value_template: '{{ value| float| round(1)}}'
    unit_of_measurement: Gb
    icon: mdi:alpha-r-box

# ############################################################################
# Hardware sensors (Ubuntu) - MQTT - MDADM Arrays State
# ############################################################################
  - platform: mqtt
    name: md0 Status
    state_topic: "ubuntu/mdstat/md0"
    value_template: '{{ value }}'
    icon: mdi:harddisk
    
  - platform: mqtt
    name: md1 Status
    state_topic: "ubuntu/mdstat/md1"
    value_template: '{{ value }}'
    icon: mdi:harddisk

  - platform: mqtt
    name: md2 Status
    state_topic: "ubuntu/mdstat/md2"
    value_template: '{{ value }}'
    icon: mdi:harddisk
    
  - platform: mqtt
    name: md3 Status
    state_topic: "ubuntu/mdstat/md3"
    value_template: '{{ value }}'
    icon: mdi:harddisk

  - platform: mqtt
    name: md4 Status
    state_topic: "ubuntu/mdstat/md4"
    value_template: '{{ value }}'
    icon: mdi:harddisk

  - platform: mqtt
    name: md5 Status
    state_topic: "ubuntu/mdstat/md5"
    value_template: '{{ value }}'
    icon: mdi:harddisk

# ############################################################################
# Hardware sensors (Ubuntu) - REST
# ############################################################################
#  - platform: rest
#    name: server_SSD
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[0].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs0_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[0].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_SSD boot
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[1].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs1_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[1].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_Storage
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[2].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs2_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[2].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_Backupdisk
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[3].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs3_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[3].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_Media
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[4].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs4_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[4].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_Purple
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[5].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs5_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[5].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_TempM2
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[6].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs6_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[6].mnt_point }}'
#    scan_interval: 30

#  - platform: rest
#    name: server_Temp
#    resource: http://192.168.1.14:61208/api/3/fs
#    unit_of_measurement: "%"
#    value_template: '{{ value_json[7].percent| round(0)}}'
#    scan_interval: 30
#  - platform: rest
#    name: fs7_name
#    resource: http://192.168.1.14:61208/api/3/fs
#    value_template: '{{ value_json[7].mnt_point }}'
#    scan_interval: 30
  


#  - platform: rest
#    name: cont0_cpu_load
#    resource: http://192.168.1.14:61208/api/3/docker
#    value_template: '{{ value_json["containers"][0].cpu_percent | round(0) }}'
#    unit_of_measurement: "%"
#    scan_interval: 5
#  - platform: rest
#    name: cont0_mem_usage
#    resource: http://192.168.1.14:61208/api/3/docker
#    value_template: '{{ ( value_json["containers"][0].memory.usage / 1024 / 1024 ) | int }}'
#    unit_of_measurement: "Mb"
#    scan_interval: 5
#  - platform: rest
#    name: cont0_name
#    resource: http://192.168.1.14:61208/api/3/docker
#    value_template: '{{ value_json["containers"][0].name }}'
#    scan_interval: 30


#  - platform: rest
#    resource: http://192.168.1.14:61208/api/3/mem/percent
#    name: Ubuntu MEM Used
#    value_template: '{{ value_json.percent| round(0) }}'
#    unit_of_measurement: "%"
#    scan_interval: 10
#  - platform: rest
#    name: Ubuntu CPU Load
#    resource: http://192.168.1.14:61208/api/3/cpu/total
#    unit_of_measurement: "%"
#    value_template: '{{ value_json.total | round(0) }}'
#    scan_interval: 5
#  - platform: rest
#    name: Ubuntu CPU Temp
#    resource: http://192.168.1.14:61208/api/3/sensors
#    unit_of_measurement: "°C"
#    value_template: '{{ value_json[2].value| round(0) }}'
#    scan_interval: 5
